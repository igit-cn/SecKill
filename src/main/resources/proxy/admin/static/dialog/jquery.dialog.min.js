/**
 * 基于JQuery UI 弹出框组件
 * date: 2016-04-27
 * author: summer <summer@68coder.com>
 * version: 1.2.0
 */
!function(a){var f,i,b="@.SUI.DIALOG.HANDLE",c="@.SUI.DIALOG.DATA",d="@.SUI.DIALOG.OPENER",e=function(a){var b=new Date;return a+"_"+(Math.floor(999*Math.random())+100)+b.getDate()+b.getHours()+b.getMinutes()+b.getSeconds()},g=function(b,c,d,e){var g,h;"object"==typeof c&&(d=c.callback,e=c.msec),clearTimeout(f),a("#dialogToast").remove(),g="undefined"==typeof e?!0:!1,h="loading"==b?!0:!1,h&&"undefined"==typeof c&&(c="数据加载中..."),a("body").append('<div id="dialogToast" class="dialog-toast dialog-toast-'+b+'">'+c+"</div>"),a("#dialogToast").css({marginLeft:-(a("#dialogToast").outerWidth()/2)+"px",top:"0px"}),(h&&!g||!h)&&(g&&(e=3),f=setTimeout(function(){a("#dialogToast").fadeOut("fast",function(){a(this).remove()})},1e3*e))},h=function(b,c,d,f){var g,h,i,j;"undefined"==typeof f&&(f={}),g=a.extend({message:c,ok:d,title:"温馨提示",cancel:null,okVal:"确定",cancelVal:"取消"},f),"object"==typeof c&&(g=a.extend(g,{message:"",ok:null},c)),h=e(b),a("body").append('<div id="'+h+'" style="display:none"><div class="dialog-ui-icon dialog-ui-'+b+'">'+g.message+"</div></div>"),i={modal:!0,resizable:!1,dialogClass:"jquery-ui-dialog",width:360,minHeight:150,closeText:"",title:g.title,focus:function(){a(this).parent().find("button").blur()},close:function(){a(this).remove()}},j=[{text:g.okVal,click:function(){a(this).dialog("close").remove(),a.isFunction(g.ok)&&g.ok()}}],"confirm"==b&&j.push({text:g.cancelVal,click:function(){a(this).dialog("close").remove(),a.isFunction(g.cancel)&&g.cancel()}}),i.buttons=j,a("#"+h).dialog(i)};"undefined"==typeof a.sui&&(a.sui={}),i={},a.each(["alert","error","success","confirm"],function(a,b){i[b]=function(a,c,d){window.top!=window.self?top.$.sui[b](a,c,d):h(b,a,c,d)}}),i.loading={show:function(b,c){if(window.top!=window.self)return top.$.sui.loading.show(b,c),void 0;"undefined"==typeof b&&(b="正在提交数据");var d='<div class="jquery-dialog-loading"><div class="loading-icon"></div><p class="loading_content">'+b+'</p></div><div class="loading-overlay"></div>';a(".jquery-dialog-loading").remove(),a(".loading-overlay").remove(),a("body").append(d),"undefined"!=typeof c&&setTimeout(function(){a(".jquery-dialog-loading").fadeOut("fast",function(){a(this).remove()}),a(".loading-overlay").fadeOut("fast",function(){a(this).remove()})},1e3*c)},hide:function(){return window.top!=window.self?(top.$.sui.loading.hide(),void 0):(a(".jquery-dialog-loading").fadeOut("fast",function(){a(this).remove()}),a(".loading-overlay").fadeOut("fast",function(){a(this).remove()}),void 0)}},i.dialog={open:function(f,g,h,i){var j;return window.top!=window.self?top.$.sui.dialog.open(f,g,h,i):("object"==typeof f&&(i=f,f=i.url,g=i.data,h=i.callback),i=a.extend({scroll:"no",modal:!0,resizable:!1},i),j=e("dialog"),a("body").append('<div id="'+j+'" style="display:none"><iframe name="'+j+'_iframe" id="'+j+'_iframe" scrolling="'+i.scroll+'" frameborder="0" style="border:0px none;"></iframe></div><iframe id="'+j+'_iframe_detector" style="display:none"></iframe>'),a.sui.loading.show("页面加载中..."),a("#"+j+"_iframe_detector").load(function(){var e,k,l,m,n,o,p;a.sui.loading.hide(),a(this).show(),e=/^(http:|https:|ftp:)\/\/.*/.test(f),e?(k="消息窗口",l=800,m=400,n=200,o=200):(k=a(this).contents().find("title").html(),l=a(this).contents().find("body").outerWidth(!0),m=a(this).contents().find("body").outerHeight(!0),n=l,o=m+40),k="undefined"!=typeof i.title?i.title:k,"undefined"!=typeof i.width&&(n=l=i.width),"undefined"!=typeof i.height&&(m=i.height,o=m+40),p={modal:i.modal,resizable:i.resizable,dialogClass:"jquery-ui-dialog-iframe",width:l,height:m+50,minWidth:n,minHeight:o,closeText:"",title:k,close:function(){a("#"+j+"_iframe").remove(),a(this).remove()},beforeClose:function(){var d=a("#"+j+"_iframe")[0].contentWindow;a.isFunction(h)&&"undefined"!=typeof d[c]&&h(d[c])},resize:function(b,c){a("#"+j+"_iframe").css({width:c.size.width+"px",height:c.size.height-40+"px"})},focus:function(){a(this).parent().find("button").blur()}},a("#"+j).dialog(p),a("#"+j+"_iframe").css({width:l+"px",height:m+"px"}),a("#"+j+"_iframe").css({width:l+"px",height:m+"px"}),a("#"+j+"_iframe").attr("src",f),a("#"+j+"_iframe").load(function(){a(this)[0].contentWindow[b]=j,g&&(a(this)[0].contentWindow[d]=g),a.isFunction(a(this)[0].contentWindow.onloadSuccess)&&a(this)[0].contentWindow.onloadSuccess()}),a("#"+j+"_iframe_detector").remove()}),a("#"+j+"_iframe_detector").attr("src",f),j)},close:function(c){var d="undefined"!=typeof self.window[b]&&"undefined"==typeof c;return d?(top.$.sui.dialog.close(self.window[b]),void 0):window.top!=window.self?(top.$.sui.dialog.close(c),void 0):(d||a("#"+c).dialog("close"),void 0)},data:function(a){return"undefined"==typeof a?self.window[d]?self.window[d]:"":(window.top!=window.self&&"undefined"!=typeof self.window[b]&&(self.window[c]=a),void 0)}},i.message=function(b,c,d){return window.top!=window.self?(top.$.sui.message(b,c,d),void 0):(a("#dialog_message").remove(),a("body").append('<div id="dialog_message" style="display:none">'+b+"</div>"),a("#dialog_message").dialog({title:c,modal:!1,resizable:!1,dialogClass:"jquery-ui-dialog-message",width:270,minHeight:180,position:{at:"right bottom",of:window},closeText:"",close:function(){a(this).remove()}}),"undefined"!=typeof d&&setTimeout(function(){a("#dialog_message").dialog("close").remove()},1e3*d),void 0)},i.toast={},a.each(["warning","error","success"],function(a,b){i.toast[b]=function(a,c,d){window.top!=window.self?top.$.sui.toast[b](a,c,d):g(b,a,c,d)}}),i.toast.loading={show:function(a,b,c){window.top!=window.self?top.$.sui.toast.loading.show(a,b,c):g("loading",a,b,c)},hide:function(){window.top!=window.self?top.$.sui.toast.loading.hide():a(".dialog-toast-loading").fadeOut("fast",function(){a(this).remove()})}},a.sui=a.extend(a.sui,i)}(jQuery);